module.exports.default=function(n){var i={};function a(e){if(i[e])return i[e].exports;var t=i[e]={exports:{},id:e,loaded:false};n[e].call(t.exports,t,t.exports,a);t.loaded=true;return t.exports}a.m=n;a.c=i;a.p="";return a(0)}([function(e,t,n){"use strict";var i=n(1);var a=y(i);var o=n(4);var r=n(5);var s=n(6);var u=n(7);var f=n(8);var l=n(9);var d=n(10);var c=n(11);var h=n(12);var p=n(13);var g=n(2);var v=n(14);var m=n(15);function y(e){return e&&e.__esModule?e:{default:e}}(0,g.initUtil)(a.default);(0,o.initHTTP)(a.default);(0,r.initUser)(a.default);(0,s.initConfig)(a.default);(0,u.initData)(a.default);(0,f.initShare)(a.default);(0,l.initProcess)(a.default);(0,d.initPayment)(a.default);(0,c.initAD)(a.default);(0,h.initHook)(a.default);(0,p.initInvite)(a.default);(0,v.initEvent)(a.default);(0,m.initMessage)(a.default);e.exports=window.wxsdk=a.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n){if(Object.prototype.hasOwnProperty.call(n,i)){e[i]=n[i]}}}return e};var i=n(2);var r=a(i);function a(e){return e&&e.__esModule?e:{default:e}}var d={tmp:{},options:{scheme:"https://",host:"api.wxsdk.cn/v1/api",apiVersion:"v1",USER_KEY:"ws_user",CONF_KEY:"ws_conf",DATA_KEY:"ws_data",share10:true,commonDuration:120,allowAld:false},conf:{},user:{},data:{},version:"1.0.8",mode:"default",debug:true,shareCallbackData:{},shareTempData:{},shareGiftTempData:{},_initCallbacks:[],_showCallbacks:[],_hideCallbacks:[],_afterHideCallbacks:[],_shareCallbacks:[],_openFromShareCallbacks:[],_openFromCodeCallbacks:[],_onInit:function e(){var t=true;var n=false;var i=undefined;try{for(var a=this._initCallbacks[Symbol.iterator](),o;!(t=(o=a.next()).done);t=true){var r=o.value;r&&r()}}catch(e){n=true;i=e}finally{try{if(!t&&a.return){a.return()}}finally{if(n){throw i}}}},_onShow:function e(t){console.log("onShow:",t,"mode:",this.mode);if(this.mode!=="default"){if(this.shareCallbackData&&this.shareCallbackData.callback&&this.mode=="shareAppMessage"){this.shareCallbackData.callback(t,Date.now()-this.shareCallbackData.ms);this.shareCallbackData={}}this.mode="default"}else{var n=true;var i=false;var a=undefined;try{for(var o=this._showCallbacks[Symbol.iterator](),r;!(n=(r=o.next()).done);n=true){var s=r.value;s&&s(t)}}catch(e){i=true;a=e}finally{try{if(!n&&o.return){o.return()}}finally{if(i){throw a}}}if(t.query&&t.query.type==="share"){d._openFromShare("onShow",t.query,t)}else if(t.query&&t.query.scene&&t.query.scene.substring(0,5)==="code_"){d._openFromCode("onShow",t.query.scene,t)}if(this.user&&t.shareTicket&&t.query&&t.query.uid==this.user.id){for(var u in this.shareTempData){if(u==t.query.share_tid){d._shareCallback(this.shareTempData[u],t)}}}}},_onHide:function e(t){console.log("onHide:",t,"mode:",this.mode);if(this.mode==="default"){var n=true;var i=false;var a=undefined;try{for(var o=this._hideCallbacks[Symbol.iterator](),r;!(n=(r=o.next()).done);n=true){var s=r.value;s&&s(t)}}catch(e){i=true;a=e}finally{try{if(!n&&o.return){o.return()}}finally{if(i){throw a}}}var u=true;var f=false;var l=undefined;try{for(var d=this._afterHideCallbacks[Symbol.iterator](),c;!(u=(c=d.next()).done);u=true){var h=c.value;h&&h(t)}}catch(e){f=true;l=e}finally{try{if(!u&&d.return){d.return()}}finally{if(f){throw l}}}}},_openFromShare:function e(t,n,i){var a=true;var o=false;var r=undefined;try{for(var s=this._openFromShareCallbacks[Symbol.iterator](),u;!(a=(u=s.next()).done);a=true){var f=u.value;f&&f({from:t,query:n,options:i})}}catch(e){o=true;r=e}finally{try{if(!a&&s.return){s.return()}}finally{if(o){throw r}}}},_openFromCode:function e(u,f,l){d.get({url:"/share/qrcode",data:{scene:f},success:function e(t){var n=true;var i=false;var a=undefined;try{for(var o=d._openFromCodeCallbacks[Symbol.iterator](),r;!(n=(r=o.next()).done);n=true){var s=r.value;s&&s({from:u,scene:f,options:l,query:t.data})}}catch(e){i=true;a=e}finally{try{if(!n&&o.return){o.return()}}finally{if(i){throw a}}}}})},_shareCallback:function e(t,n){wx.getShareInfo({shareTicket:n.shareTicket,success:function(e){if(t.onShareTicketSuccess){t.onShareTicketSuccess(e)}d.shareLog(t,"click",n.shareTicket,e,n)}.bind(this),fail:function(e){if(t.onShareTicketFail){t.onShareTicketFail(e)}d.shareLog(t,"click",n.shareTicket,{},n)}.bind(this)})},onInit:function e(t){this._initCallbacks.push(t)},onShow:function e(t){this._showCallbacks.push(t)},onHide:function e(t){this._hideCallbacks.push(t)},afterHide:function e(t){this._afterHideCallbacks.push(t)},openFromShare:function e(t){this._openFromShareCallbacks.push(t)},openFromCode:function e(t){this._openFromCodeCallbacks.push(t)},init:function e(t){this.options=o({},r.default.copy(t,this.options));this.systemInfo=wx.getSystemInfoSync();this.launchOptions=wx.getLaunchOptionsSync();if(this.launchOptions&&this.launchOptions.query&&this.launchOptions.query.ws_path){try{this.launchOptions.query.ws_path=decodeURIComponent(decodeURIComponent(this.launchOptions.query.ws_path));var n=this.launchOptions.query.ws_path;var i=n.indexOf("appid=");var a=n.indexOf("&path=");if(a>0){this.launchOptions.query.jump_appid=n.substr(0,a);this.launchOptions.query.jump_path=n.substr(a,n.length)}else{this.launchOptions.query.jump_appid=n.substr(0,n.length)}}catch(e){console.error(e)}}this.user=wx.getStorageSync(this.options.USER_KEY);this.conf=wx.getStorageSync(this.options.CONF_KEY);this.data=wx.getStorageSync(this.options.DATA_KEY);this.log("conf:",this.conf);wx.onShow(this._onShow.bind(this));wx.onHide(this._onHide.bind(this))},onLogined:function e(){var t=this.launchOptions;if(t.query&&t.query.type==="share"){d._openFromShare("onLaunch",t.query,t)}else if(t.query&&t.query.scene&&t.query.scene.substring(0,5)==="code_"){d._openFromCode("onLaunch",t.query.scene,t)}this._onInit()}};t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var o=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.initUtil=u;var i=n(3);var r=a(i);function a(e){return e&&e.__esModule?e:{default:e}}var s={sign:function e(t,n){if(typeof t=="string"){return s.signSort(t,n)}else if((typeof t==="undefined"?"undefined":o(t))=="object"){var i=[];for(var a in t){i.push(a+"="+t[a])}return s.signSort(i.join("&"),n)}},signSort:function e(t,n){var i=t.split("&").sort().join("&");var a=i+"&key="+n;return(0,r.default)(a).toUpperCase()},S4:function e(){return((1+Math.random())*65536|0).toString(16).substring(1)},guid:function e(){return Date.now()+"-"+s.S4()},compareVersion:function e(t,n){t=t.split(".");n=n.split(".");var i=Math.max(t.length,n.length);while(t.length<i){t.push("0")}while(n.length<i){n.push("0")}for(var a=0;a<i;a++){var o=parseInt(t[a]);var r=parseInt(n[a]);if(o>r){return true}else if(o<r){return false}}return true},copy:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var i=n?n:t&&t.push?[]:{};for(var a in t){i[a]=o(t[a])==="object"?s.copy(t[a]):t[a]}return i},randomSort:function e(t){var n;for(var i=0;i<t.length;i++){var a=parseInt(Math.random()*t.length+"");n=t[a];t[a]=t[i];t[i]=n}return t},getUrlParam:function e(t,n){if(!t){return null}var i={};t.replace(/(?=\??)(\w+)=(\w+)/g,function(e,t,n){i[t]=i[t]?[].concat(i[t],n):n});return n?i[n]||"":i}};t.default=s;function u(t){t.getUrlParam=s.getUrlParam;t.checkSDK=function(n,i){var a=this;return function(e,t){if(!a.requireSDK(n)){a.log("微信SDK版本过低："+a.systemInfo.SDKVersion+",需要更新至"+n);t&&typeof t==="function"&&t([a.systemInfo.SDKVersion,n]);return}return i.apply(a,[e])}};t.requireSDK=function(e){return s.compareVersion(this.systemInfo.SDKVersion,e)};t.requireSystemVersion=function(e){return s.compareVersion(this.systemInfo.version,e)};t.isIPhoneX=function(){return this.systemInfo&&this.systemInfo.model.indexOf("iPhone X")!=-1};t.isIOS=function(){return this.systemInfo&&this.systemInfo.model.indexOf("iOS")!=-1};t.isAndroid=function(){return this.systemInfo&&this.systemInfo.model.indexOf("Android")!=-1};t.toFixed=function(e,t){var n=e.toFixed(t)+"";while(n[n.length-1]==="0"){n=n.substring(0,n.length-1);if(n[n.length-1]==="."){n=n.substring(0,n.length-1);break}}return n};t.log=function e(){try{if(this.debug&&console&&console.log){for(var t=arguments.length,n=Array(t),i=0;i<t;i++){n[i]=arguments[i]}return console.log.apply(console,n);console.log(e.caller)}}catch(e){}};t.setAlertCallback=function(e){t._alertCallback=e};t.alert=function(e){if(t._alertCallback){t._alertCallback(e)}else{wx.showModal({content:e})}};t.trace=function(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};this.post({url:"/log/trace",data:{key:e,pos:t,data:n}})};t.getServerTime=function(){if(!t.conf||!t.conf.server_time){return 0}return t.conf.server_time}}},function(_,S,b){var I;"use strict";var k=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(e){"use strict";function d(e,t){var n=(e&65535)+(t&65535);var i=(e>>16)+(t>>16)+(n>>16);return i<<16|n&65535}function r(e,t){return e<<t|e>>>32-t}function s(e,t,n,i,a,o){return d(r(d(d(t,e),d(i,o)),a),n)}function c(e,t,n,i,a,o,r){return s(t&n|~t&i,e,t,a,o,r)}function h(e,t,n,i,a,o,r){return s(t&i|n&~i,e,t,a,o,r)}function p(e,t,n,i,a,o,r){return s(t^n^i,e,t,a,o,r)}function g(e,t,n,i,a,o,r){return s(n^(t|~i),e,t,a,o,r)}function u(e,t){e[t>>5]|=128<<t%32;e[(t+64>>>9<<4)+14]=t;var n;var i;var a;var o;var r;var s=1732584193;var u=-271733879;var f=-1732584194;var l=271733878;for(n=0;n<e.length;n+=16){i=s;a=u;o=f;r=l;s=c(s,u,f,l,e[n],7,-680876936);l=c(l,s,u,f,e[n+1],12,-389564586);f=c(f,l,s,u,e[n+2],17,606105819);u=c(u,f,l,s,e[n+3],22,-1044525330);s=c(s,u,f,l,e[n+4],7,-176418897);l=c(l,s,u,f,e[n+5],12,1200080426);f=c(f,l,s,u,e[n+6],17,-1473231341);u=c(u,f,l,s,e[n+7],22,-45705983);s=c(s,u,f,l,e[n+8],7,1770035416);l=c(l,s,u,f,e[n+9],12,-1958414417);f=c(f,l,s,u,e[n+10],17,-42063);u=c(u,f,l,s,e[n+11],22,-1990404162);s=c(s,u,f,l,e[n+12],7,1804603682);l=c(l,s,u,f,e[n+13],12,-40341101);f=c(f,l,s,u,e[n+14],17,-1502002290);u=c(u,f,l,s,e[n+15],22,1236535329);s=h(s,u,f,l,e[n+1],5,-165796510);l=h(l,s,u,f,e[n+6],9,-1069501632);f=h(f,l,s,u,e[n+11],14,643717713);u=h(u,f,l,s,e[n],20,-373897302);s=h(s,u,f,l,e[n+5],5,-701558691);l=h(l,s,u,f,e[n+10],9,38016083);f=h(f,l,s,u,e[n+15],14,-660478335);u=h(u,f,l,s,e[n+4],20,-405537848);s=h(s,u,f,l,e[n+9],5,568446438);l=h(l,s,u,f,e[n+14],9,-1019803690);f=h(f,l,s,u,e[n+3],14,-187363961);u=h(u,f,l,s,e[n+8],20,1163531501);s=h(s,u,f,l,e[n+13],5,-1444681467);l=h(l,s,u,f,e[n+2],9,-51403784);f=h(f,l,s,u,e[n+7],14,1735328473);u=h(u,f,l,s,e[n+12],20,-1926607734);s=p(s,u,f,l,e[n+5],4,-378558);l=p(l,s,u,f,e[n+8],11,-2022574463);f=p(f,l,s,u,e[n+11],16,1839030562);u=p(u,f,l,s,e[n+14],23,-35309556);s=p(s,u,f,l,e[n+1],4,-1530992060);l=p(l,s,u,f,e[n+4],11,1272893353);f=p(f,l,s,u,e[n+7],16,-155497632);u=p(u,f,l,s,e[n+10],23,-1094730640);s=p(s,u,f,l,e[n+13],4,681279174);l=p(l,s,u,f,e[n],11,-358537222);f=p(f,l,s,u,e[n+3],16,-722521979);u=p(u,f,l,s,e[n+6],23,76029189);s=p(s,u,f,l,e[n+9],4,-640364487);l=p(l,s,u,f,e[n+12],11,-421815835);f=p(f,l,s,u,e[n+15],16,530742520);u=p(u,f,l,s,e[n+2],23,-995338651);s=g(s,u,f,l,e[n],6,-198630844);l=g(l,s,u,f,e[n+7],10,1126891415);f=g(f,l,s,u,e[n+14],15,-1416354905);u=g(u,f,l,s,e[n+5],21,-57434055);s=g(s,u,f,l,e[n+12],6,1700485571);l=g(l,s,u,f,e[n+3],10,-1894986606);f=g(f,l,s,u,e[n+10],15,-1051523);u=g(u,f,l,s,e[n+1],21,-2054922799);s=g(s,u,f,l,e[n+8],6,1873313359);l=g(l,s,u,f,e[n+15],10,-30611744);f=g(f,l,s,u,e[n+6],15,-1560198380);u=g(u,f,l,s,e[n+13],21,1309151649);s=g(s,u,f,l,e[n+4],6,-145523070);l=g(l,s,u,f,e[n+11],10,-1120210379);f=g(f,l,s,u,e[n+2],15,718787259);u=g(u,f,l,s,e[n+9],21,-343485551);s=d(s,i);u=d(u,a);f=d(f,o);l=d(l,r)}return[s,u,f,l]}function f(e){var t;var n="";var i=e.length*32;for(t=0;t<i;t+=8){n+=String.fromCharCode(e[t>>5]>>>t%32&255)}return n}function l(e){var t;var n=[];n[(e.length>>2)-1]=undefined;for(t=0;t<n.length;t+=1){n[t]=0}var i=e.length*8;for(t=0;t<i;t+=8){n[t>>5]|=(e.charCodeAt(t/8)&255)<<t%32}return n}function t(e){return f(u(l(e),e.length*8))}function n(e,t){var n;var i=l(e);var a=[];var o=[];var r;a[15]=o[15]=undefined;if(i.length>16){i=u(i,e.length*8)}for(n=0;n<16;n+=1){a[n]=i[n]^909522486;o[n]=i[n]^1549556828}r=u(a.concat(l(t)),512+t.length*8);return f(u(o.concat(r),512+128))}function i(e){var t="0123456789abcdef";var n="";var i;var a;for(a=0;a<e.length;a+=1){i=e.charCodeAt(a);n+=t.charAt(i>>>4&15)+t.charAt(i&15)}return n}function a(e){return unescape(encodeURIComponent(e))}function o(e){return t(a(e))}function v(e){return i(o(e))}function m(e,t){return n(a(e),a(t))}function y(e,t){return i(m(e,t))}function w(e,t,n){if(!t){if(!n){return v(e)}return o(e)}if(!n){return y(t,e)}return m(t,e)}if(true){!(I=function(){return w}.call(S,b,S,_),I!==undefined&&(_.exports=I))}else if((typeof _==="undefined"?"undefined":k(_))==="object"&&_.exports){_.exports=w}else{e.md5=w}})(undefined)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.initHTTP=p;var i=n(1);var s=o(i);var a=n(2);var u=o(a);function o(e){return e&&e.__esModule?e:{default:e}}function r(t){var n=t.success,i=t.fail;if(t.method=="GET"){t.url=h(t.url,t.data)}else{t.url=h(t.url)}if(!t.header){t.header={}}t.header.Authorization=s.default.isLogined()?s.default.user.token:"";t.header.appid=s.default.options.appid;t.success=function(e){if(e.data.key==="LOGIN_REQUIRED"){s.default.log("login required:",t.url,t,e);s.default.doLogin()}else if(e.data.code===0){s.default.log("success:",t.url,t,e);if(n){n(e.data)}}else if(i){s.default.log("fail:",t.url,t,e);i(e.data)}else{s.default.log("unknown:",t.url,t,e)}};t.fail=function(e){s.default.log("error:",t.url,t,e);if(i){i(e)}};return wx.request(t)}function f(e){e.method="GET";return r(e)}function l(e){e.method="POST";return r(e)}function d(e){e.method="PUT";return r(e)}function c(e){e.method="DELETE";return r(e)}function h(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(e){if(e.indexOf("?")==-1){e+="?"}var n=[];if(s.default.isLogined()){n.push("user="+s.default.user.id)}if(s.default.launchOptions){var i=s.default.launchOptions.query;if(i){if(i.uid){n.push("uid="+i.uid)}if(i.channel){n.push("channel="+i.channel)}if(i.share_id){n.push("share_id="+i.share_id)}if(i.share_tid){n.push("share_tid="+i.share_tid)}if(i.pos){n.push("share_pos="+i.pos)}if(i.scene){n.push("scene="+decodeURIComponent(i.scene))}}}n.push("v="+s.default.version);n.push("version="+s.default.options.version);n.push("appid="+s.default.options.appid);n.push("t="+Date.now());if(e.charAt(e.length-1)!=="?"&&e.charAt(e.length-1)!=="&"){e+="&"}e+=n.join("&");var a=e.split("?")[1];if(t){var o=[];for(var r in t){o.push(r+"="+t[r])}a+="&"+o.join("&")}e+="&sign="+u.default.sign(a,s.default.options.secret);if(e.startsWith("/")){return s.default.options.scheme+s.default.options.host+e+"/"}}return e}function p(e){e.request=r;e.get=f;e.post=l;e.put=d;e.delete=c;e.formatURL=h}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.initUser=n;function n(a){a.isLogined=function(){return a.user&&a.user.token};a.getLoginStatus=function(){if(a.isLogined()){return"success"}else if(a.isCheckSession||a.isLogining){return"logining"}else{return"fail"}};a.login=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(!e){a.isCheckSession=true;wx.checkSession({success:function(){a.checkLogin(e);a.isCheckSession=false}.bind(a),fail:function(){a.doLogin(e);a.isCheckSession=false}.bind(a)})}else{a.doLogin(e)}};a.checkLogin=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(a.isLogined()){a.loginSuccess(e);if(!a.requireSDK("2.0.3")&&a.needUserInfo()){a.getUserInfo()}}else{a.doLogin(e)}};a.checkCode2access=function(e){var t=e.session_key?e:null;a.post({url:"/auth/code2access_token",data:e,success:function(e){a.isLogining=false;a.saveUser(e.data.user);a.checkLogin(e.data.data)}.bind(a),fail:a.loginFail.bind(a)})};a.doLogin=function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;if(a.isLogining){return}a.isLogining=true;a.user=null;if(!e){wx.login({success:function(e){if(e.code){a.log("getCode:",e.code);var t={code:e.code,appid:a.options.appid};if(a.launchOptions){if(a.launchOptions.scene){t.scene=a.launchOptions.scene}if(a.systemInfo){if(a.systemInfo.brand){t.brand=a.systemInfo.brand}if(a.systemInfo.model){t.model=a.systemInfo.model}if(a.systemInfo.platform){t.platform=a.systemInfo.platform}if(a.systemInfo.system){t.system=a.systemInfo.system}if(a.systemInfo.language){t.language=a.systemInfo.language}if(a.systemInfo.version){t.appVersion=a.systemInfo.version}if(a.systemInfo.SDKVersion){t.sdkVersion=a.systemInfo.SDKVersion}if(a.systemInfo.language){t.language=a.systemInfo.language}}}a.checkCode2access(t)}else{a.loginFail(e)}}.bind(a),fail:a.loginFail.bind(a)})}else{a.checkCode2access(e)}};a.loginSuccess=function(e){var t=a.conf&&a.conf.last?a.conf.last:0;if(!t||Date.now()-t>a.options.commonDuration*1e3||!e){a.getCommon(e)}else{a.doLoginSuccess(e,a.data);a.onLogined()}};a.isDenyLoc=function(e){if(!a.user||typeof e!=="string")return false;var t=e.split(","),n;for(var i=0;i<t.length;i++){n=t[i].trim();if(n===a.user.city||n===a.user.province||n===a.user.country){return true}}return false};a.setDenyConfig=function(){if(!a.conf||!a.user)return;Object.keys(a.conf).forEach(function(t){if(t.indexOf("deny_")==0&&a.conf[t]!=undefined){var e=t.substr(5);a.conf[e]=!a.isDenyLoc(a.conf[t])}else if(t==="games"&&a.conf[t]){Object.keys(a.conf[t]).forEach(function(e){a.setDenyAd(a.conf[t][e])})}})};a.setDenyAd=function(e){var t=Array.isArray(e)?e:[e];t.forEach(function(e){if(e&&e.loc&&a.isDenyLoc(e.loc)){e.image=e.loc_image||e.image;e.icon=e.loc_icon||e.icon}if(e&&e.sequence&&e.seq_speed){var t=e.sequence.split(",");if(t&&t.length>0){e.sequence_icon=t}}})};a.getCommon=function(n){var e={};a.post({url:"/user/common",data:e,success:function(e){var t=e?e.data.data:null;a.conf=e.data.conf;a.conf.last=Date.now();a.setDenyConfig();wx.setStorageSync(a.options.CONF_KEY,a.conf);if(!a.data){a.data=e.data.data;wx.setStorageSync(a.options.DATA_KEY,a.data)}else{if(t&&t.updateTimestamp){if(a.data.updateTimestamp&&a.data.updateTimestamp>t.updateTimestamp){a.setAllData(a.data,true)}else{a.setAllData(t)}}else{a.setAllData(a.data,true)}}n=n||{};n.data=e.data.data;a.doLoginSuccess(n,e.data.data);a.onLogined()}.bind(a),fail:function(e){a.loginFail(e)}.bind(a)})};a.getVisitorCommon=function(){var e={};a.post({url:"/user/visitor_common",data:e,success:function(e){a.conf=e.data.conf;a.conf.last=Date.now();wx.setStorageSync(a.options.CONF_KEY,a.conf);a.doLoginSuccess(e,a.data)}.bind(a),fail:function(e){a.loginFail(e)}.bind(a)})};a.doLoginSuccess=function(e,t){a.isLogining=false;if(a.loginCompleteCallback){a.loginCompleteCallback(e,t)}if(a.loginSuccessCallback){a.loginSuccessCallback(e,t)}};a.loginFail=function(e){a.isLogining=false;if(a.loginCompleteCallback){a.loginCompleteCallback(e)}if(a.loginFailCallback){a.loginFailCallback(e)}};a.onLoginSuccess=function(e){a.loginSuccessCallback=e};a.onLoginFail=function(e){a.loginFailCallback=e};a.onLoginComplete=function(e){a.loginCompleteCallback=e};a.checkUserInfo=function(){if(a.needUserInfo()){a.getUserInfo()}};a.needUserInfo=function(){return!a.user||!a.user.nickname||!a.user.avatar};a.getUserInfo=function(){wx.getUserInfo({withCredentials:true,success:function(e){a.post({url:"/auth/update_userinfo",data:e,success:function(e){a.saveUser(e.data);if(!a.needUserInfo()){a.getUserInfoSuccess()}else{a.getUserInfoFail(e)}}.bind(a),fail:a.getUserInfoFail.bind(a)});return e}.bind(a),fail:a.getUserInfoFail.bind(a)})};a.getUserInfoSuccess=function(e){};a.getUserInfoFail=function(e){};a.saveUser=function(e){a.user=e;a.user.last=Date.parse(new Date);wx.setStorageSync(a.options.USER_KEY,a.user)};a.removeUser=function(){a.user=null;wx.removeStorage(a.options.USER_KEY)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.initConfig=s;var i=n(1);var a=o(i);function o(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return a.default.conf&&typeof a.default.conf[e]!=="undefined"?a.default.conf[e]:t}function s(e){e.getConfig=r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.initData=p;var i=n(1);var h=a(i);function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return h.default.data&&typeof h.default.data[e]!=="undefined"?h.default.data[e]:t}function r(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(!h.default.data){h.default.data={}}h.default.data[e]=t;if(n){h.default.postData(e)}}function s(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;e.updateTimestamp=Date.now();h.default.data=e;if(t){h.default.postData()}else{wx.setStorageSync(h.default.options.DATA_KEY,h.default.data)}}function u(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var a=h.default.getData(e,i)+t;h.default.setData(e,a,n);return a}function f(e){return JSON.parse(JSON.stringify(e))}function l(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;h.default.data=f(h.default.data);wx.setStorageSync(h.default.options.DATA_KEY,h.default.data);var t={data:h.default.data};h.default.post({url:"/user/data",data:t})}function d(e){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var t=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var a=arguments.length>4&&arguments[4]!==undefined?arguments[4]:"default";var o={};if(e instanceof Object){var r=e;o={id:r.id,score:r.score,time:r.time,version:h.default.options.version,data:r.data,key:r.key}}else{o={id:e,score:n,time:t,version:h.default.options.version,data:i,key:a}}h.default.post({url:"/score",data:o,success:function e(t){h.default.log("提交分数成功：",n,t)},fail:function e(t){h.default.log("提交分数失败：",n,t)}})}function c(e){var t=e.key,n=t===undefined?"default":t,i=e.scale,a=i===undefined?"week":i,o=e.skip,r=o===undefined?0:o,s=e.limit,u=s===undefined?10:s,f=e.success,l=f===undefined?null:f,d=e.fail,c=d===undefined?null:d;h.default.get({url:"/score",data:{score_key:n,scale:a,skip:r,limit:u},success:function e(t){l&&l(t.data)},fail:function e(t){c&&c(t)}})}function p(e){e.getData=o;e.setData=r;e.setAllData=s;e.incData=u;e.postData=l;e.postGameScore=d;e.getScoreRank=c}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.initShare=n;function n(b){b.share=function(e){if(b.options.allowAld){b.aldShareAppMessage(this.createShareOptions(e))}else{b.shareAppMessage(this.createShareOptions(e))}if(this.options.share10){this.log("share10");this.shareLog(e,"share10","",{},{})}if(e.onShareBack){b.shareCallbackData={callback:e.onShareBack,ms:Date.now()}}};b.createShareOptions=function(e){if(!e.pos){e.pos="default"}var t=this.getShareInfo(e);e.shareId=t.shareId;e.imageUrlId=t.imageUrlId;if(!e.title)e.title=t.title;if(!e.imageUrl)e.imageUrl=t.imageUrl;if(!e.success)e.success=t.success;if(!e.fail)e.fail=t.fail;if(!e.onHttpError)e.onHttpError=t.onHttpError;if(!e.tid)e.tid=""+Date.now();var n="type=share&pos="+e.pos+"&share_id="+t.shareId+"&share_tid="+e.tid;if(this.isLogined()){n+="&uid="+this.user.id}if(e.gift){n+="&gift="+e.gift}if(!e.query){e.query=n}else if(e.query.indexOf(0)=="&"){e.query=n+e.query;b.log("new share query: "+e.query)}else{e.query=n+"&"+e.query;b.log("new share query: "+e.query)}b.shareTempData[e.tid]=e;var i={title:e.title,imageUrl:e.imageUrl,query:e.query,success:this.shareSuccess(e),fail:this.shareFail(e),complete:e.complete};if(b.requireSDK("2.4.3")&&e.imageUrlId){i.imageUrlId=e.imageUrlId}return i};b.createGameRecorderShareButton=function(e){var t=e.pos,n=e.bgm,i=n===undefined?null:n,a=e.style,o=a===undefined?null:a,r=e.text,s=r===undefined?"分享录屏":r,u=e.image,f=u===undefined?null:u,l=e.icon,d=l===undefined?null:l,c=e.timeRange,h=c===undefined?[[0,1e4]]:c,p=e.shareTitle,g=p===undefined?null:p,v=e.shareButton,m=v===undefined?"enter":v;if(!b.requireSDK("2.8.0")){b.log("createGameRecorderShareButton required v2.8.0");return false}var y={pos:t,tid:Date.now()};var w="type=share&pos="+y.pos+"&share_tid="+y.tid;if(this.isLogined()){w+="&uid="+this.user.id}var _={};if(s)_["text"]=s;if(f)_["image"]=f;if(d)_["icon"]=d;if(o)_["style"]=o;_["share"]={query:w,bgm:i,timeRange:h,title:g,button:{template:"default."+m}};var S=wx.createGameRecorderShareButton(_);S.onTap(function(e){console.log("分享错误码："+e.error.code+"，错误信息："+e.error.message)});return S};b.getShareInfo=function(e){var t="";var n="";if(this.options.share){t=this.options.share.title;n=this.options.share.imageUrl}var i=0,a=null;if(e.defaultTitle){t=e.defaultTitle}if(this.conf&&this.conf.shares){var o;if(this.conf.shares[e.pos]){o=this.conf.shares[e.pos]}else if(this.conf.shares.default){o=this.conf.shares.default}if(o){if(o.title)t=o.title;if(o.image)n=o.image;if(o.id)i=o.id;if(o.image_id)a=o.image_id}}return{title:t,imageUrl:n,shareId:i,imageUrlId:a,success:function e(){wx.showToast({title:"分享成功！",icon:"success"})},fail:function e(){wx.showToast({title:"分享失败！",icon:"fail"})},onHttpError:function e(){wx.showToast({title:"网络出错！",icon:"fail"})}}};b.shareSuccess=function(n){return function(t){console.log("shareSuccess");delete b.shareTempData[n.tid];var e=true;if(n.onShareSuccess){e=n.onShareSuccess(t)}if(e){if(t.shareTickets&&t.shareTickets.length>0){wx.getShareInfo({shareTicket:t.shareTickets[0],success:function(e){if(n.onShareTicketSuccess){n.onShareTicketSuccess(e)}this.shareLog(n,"success",t.shareTickets[0],e,t)}.bind(this),fail:function(e){if(n.onShareTicketFail){n.onShareTicketFail(e)}this.shareLog(n,"success",t.shareTickets[0],{},t)}.bind(this)})}else{if(n.onShareTicketFail){n.onShareTicketFail()}this.shareLog(n,"success","",{},t)}}}.bind(this)};b.shareFail=function(n){return function(e){console.log("shareFail");var t=true;if(n.onShareFail){t=n.onShareFail(e)}if(t){this.shareLog(n,"fail","",{},e)}}.bind(this)};b.shareLog=function(n,i,e,t,a){this.post({url:"/log/share",data:{share_id:n.shareId,title:n.title,query:n.query,image:n.imageUrl,pos:n.pos,tid:n.tid,status:i,shareTicket:e,info:t,error:a.errMsg,system_version:b.systemInfo.system,sdk_version:b.systemInfo.SDKVersion},success:function e(t){if((i==="success"||i==="click")&&n.success){n.success(t,a);delete b.shareTempData[n.tid]}else if(i==="fail"&&n.fail){n.fail(t,a)}},fail:function e(t){if((i==="success"||i==="click")&&n.onHttpError){n.onHttpError(t,a)}else if(i==="fail"&&n.fail){n.fail(t,a)}}})};b.isEnableShare=function(){if(b.conf&&b.conf.allow_share&&!b.requireSystemVersion("6.7.0")){return true}return false}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n){if(Object.prototype.hasOwnProperty.call(n,i)){e[i]=n[i]}}}return e};t.initProcess=p;var i=n(1);var a=u(i);var o=n(2);var r=u(o);function u(e){return e&&e.__esModule?e:{default:e}}function f(e,t){var n={};for(var i in e){if(t.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(e,i))continue;n[i]=e[i]}return n}var l={hasInited:false,initStartAt:Date.now(),showOptions:"",times:0,uuid:r.default.guid(),duration:0,showDuration:0,process:"init",processDuration:0};var d=0;function c(e){if(typeof e!="string"){a.default.log("setProcess():  参数类型错误");return}l.process=e;l.processDuration=Date.now()-l.initStartAt}function h(e){a.default.post({url:"/log/process",data:e,success:function e(t){a.default.log("提交游戏进度数据成功：",t)},fail:function e(t){a.default.log("提交游戏进度数据失败：",t)}})}function p(r){r.onShow(function(e){d=Date.now();l.showOptions=JSON.stringify(e)});r.afterHide(function(e){var t=Date.now();l=s({},l,{times:l.times+1,showDuration:d?t-d:t-l.initStartAt,duration:t-l.initStartAt});var n=l,i=n.hasInited,a=n.initStartAt,o=f(n,["hasInited","initStartAt"]);if(!l.hasInited){l.hasInited=true;h(s({systemInfo:JSON.stringify(r.systemInfo),launchOptions:JSON.stringify(r.launchOptions)},o))}else{h(o)}});r.setProcess=c}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.initPayment=n;function n(p){p.getPaymentResult=function(e){var t=e.success,n=t===undefined?null:t,i=e.fail,a=i===undefined?null:i;this.get({url:"/payment/result",success:function(e){this.log("获取充值数据成功",e);n&&n(e.data)}.bind(this),fail:function(e){this.log("获取充值数据失败",e);a&&a(e)}.bind(this)})};p.requestMPPayment=function(e){var n=this;var t=e.title,i=t===undefined?"点击充值链接进入充值":t,a=e.pos,o=a===undefined?"default":a,r=e.image,s=r===undefined?null:r,u=e.success,f=u===undefined?null:u,l=e.fail,d=l===undefined?null:l,c=e.complete,h=c===undefined?null:c;this.log("打开客服对话");p.openCustomerServiceConversation({sessionFrom:o,showMessageCard:true,sendMessageTitle:i,sendMessagePath:"?type=message",sendMessageImg:s||p.conf.shares.default["image"],success:function e(t){n.log("打开充值会话成功",t);h&&h();f&&f()},fail:function e(t){n.log("打开充值会话fail",t);h&&h();d&&d()}})};p.requestMPPayment=p.checkSDK("2.0.3",p.requestMPPayment)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n){if(Object.prototype.hasOwnProperty.call(n,i)){e[i]=n[i]}}}return e};t.initAD=H;var i=n(1);var k=r(i);var a=n(2);var o=r(a);function r(e){return e&&e.__esModule?e:{default:e}}var y={};var w={};var m={};var _={};var D={};var s=[];var u=120*1e3;function f(e){var t=e.pos,n=e.style,i=n===undefined?null:n,a=e.ms,o=a===undefined?0:a,r=e.force,s=r===undefined?false:r,u=e.forceTimeout,f=u===undefined?600:u,l=e.onResize,d=l===undefined?null:l,c=e.onError,h=c===undefined?null:c;if(!(k.default.conf&&k.default.conf.banners&&k.default.conf.banners[t])){k.default.log("createBanner 没有配置: "+t);return}var p=k.default.conf.banner_timeout;p&&(f=p);var g=k.default.conf.banners[t];if(!g.enable)return;var v=void 0;var m=y[t];if(m){v=w[m.adUnitId];if(v){if(m.showed){S(m.pos)}if(s||Date.now()-v.created>f*1e3){I(m)}}}if(!o){o=k.default.getConfig("banner_ms",120)}if(!m){m={adUnitId:g.adUnitId,pos:t,count:0,ms:o,duration:0,style:i,width:g.width?g.width>1?1:g.width:1,window:"*",data:[],onResize:d,onError:h,created:Date.now()};y[t]=m}m.count+=1;m.status="success";if(m.ms&&g.is_loop){m.adIntervals=m.ms}v=w[m.adUnitId];if(!v){v=w[m.adUnitId]=b({banner:m,style:i})}if(v){m.showed=Date.now();setTimeout(function(){m.showed&&v.show()},.01)}return v}function S(e){var t=y[e];if(t&&t.showed){var n=w[t.adUnitId];if(n){var i=n.style,a=i.realWidth,o=i.realHeight;var r=Date.now()-t.showed;n.hide();t.duration+=r;t.timeout&&clearTimeout(t.timeout);t.timeout=null;t.showed=null;t.window=a+"*"+Math.round(o);return true}}return false}function b(e){var t=e.banner,n=t.adIntervals,i=e.style,a=i===undefined?null:i,o=e.onResize,r=o===undefined?null:o;var s=k.default.systemInfo.screenWidth*t.width;var u=k.default.systemInfo.screenHeight;var f=u>s/375*667?(u-s/375*667)/2:0;var l=wx.createBannerAd({adUnitId:t.adUnitId,adIntervals:n,style:d({left:0,top:0,width:s,height:180*s/750},a)});l.created=Date.now();l.onError(function(e){t.status="error";t.error=e;t.timeout&&clearTimeout(t.timeout);t.timeout=null;t.showed=null;t.count=1;c(t,"error");k.default.log("banner 创建失败",t);if(y[t.pos]){delete y[t.pos]}t.onError&&t.onError(e)});l.onResize(function(e){t.onResize&&t.onResize(e,l)});l.onLoad(function(e){k.default.log("banner 加载完成",t);l.created=Date.now()});return l}function I(e){var t=w[e.adUnitId];if(t){t.hide();t.destroy();delete w[e.adUnitId];return true}return false}function c(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"onHide";var n={adUnitId:e.adUnitId,pos:e.pos,ms:e.ms,count:e.count,duration:e.duration,window:e.window,status:e.status,error:e.error,commit:t};e.count=0;e.duration=0;e.status="success";e.error="";e.data=[];k.default.log("postBannerData",n);k.default.post({url:"/log/ad/banner",data:n,success:function e(t){k.default.log("提交banner数据成功：",t)},fail:function e(t){k.default.log("提交banner数据失败：",t)}})}function g(e){if(!(k.default.conf&&k.default.conf.videos&&k.default.conf.videos[e])){k.default.log("createVideo 没有配置: "+e);return false}if(!k.default.conf.allow_video){k.default.log("视频未开启，请转到配置allow_video");return false}var t=k.default.conf.videos[e];if(!t.enable)return false;return true}function l(e){var t=e.pos,n=e.success,i=n===undefined?null:n,a=e.fail,o=a===undefined?null:a,r=e.complete,s=r===undefined?null:r;if(!g(t)){return false}var u=k.default.conf.videos[t];var f={adUnitId:u.adUnitId,pos:t,status:"success",created:Date.now(),duration:0};var l=wx.createRewardedVideoAd({adUnitId:f.adUnitId});function d(e){f.status="error";f.error=e;v(f);s&&s(e);o&&o(e);p()}function c(e){f.created=Date.now()}function h(e){s&&s(e);f.duration=Date.now()-f.created;if(e&&e.isEnded||e===undefined){i&&i({isEnded:true,duration:f.duration})}else{f.status="cancel";i&&i({isEnded:false,duration:f.duration})}v(f);p()}function p(){l.offError(d);l.offLoad(c);l.offClose(h)}l.onError(d);l.onLoad(c);l.onClose(h);l.show().catch(function(e){console.log("wxsdk.createVideo error:",e);l.load().then(function(){return l.show()})});return true}function v(e){k.default.post({url:"/log/ad/rewardedvideo",data:e,success:function e(t){k.default.log("提交激励视频数据成功：",t)},fail:function e(t){k.default.log("提交激励视频数据失败：",t)}})}function C(e){if(!(k.default.conf&&k.default.conf.interstices&&k.default.conf.interstices[e])){k.default.log("createInterstitialAd 没有配置: "+e);return false}var t=k.default.conf.interstices[e];if(!t.enable)return false;return true}function h(e){var t=e.pos,n=e.success,i=n===undefined?null:n,a=e.fail,o=a===undefined?null:a,r=e.complete,s=r===undefined?null:r,u=e.show,f=u===undefined?true:u;if(!C(t)){return false}var l=m[t];if(!l){var d=k.default.conf.interstices[t];l={adUnitId:d.adUnitId,pos:t,status:"success",created:Date.now(),duration:0,count:0};m[t]=l}var c=_[t];if(!c||c._destroyed){c=wx.createInterstitialAd({adUnitId:l.adUnitId});_[t]=c;l.created=Date.now()}function h(e){l.status="error";l.error=e;l.count=1;A(l);s&&s(e);o&&o(e);v()}function p(e){console.log("interstitial load.");l.created=Date.now();l.count+=1}function g(e){s&&s(e);l.duration+=Date.now()-l.created;v();i&&i()}function v(){c.offError(h);c.offLoad(p);c.offClose(g)}c.onError(h);c.onLoad(p);c.onClose(g);if(f){c.show().catch(function(e){console.log("wxsdk.createInterstitialAd error:",e);l.count>0&&l.count--;if(k.default.requireSDK("2.8.0")){c.load().then(function(){return c.show()})}})}return true}function p(e){var t=_[e];if(!t||t._destroyed){console.log("had no ad or interstice destroyed.");return false}t.show();return true}function A(e){k.default.post({url:"/log/ad/interstitial",data:e,success:function e(t){k.default.log("提交插屏广告数据成功：",t)},fail:function e(t){k.default.log("提交插屏广告数据失败：",t)}})}function x(e){if(k.default.conf&&k.default.conf.games){var t;if(k.default.conf.games[e]){t=k.default.conf.games[e]}else if(k.default.conf.games.default){t=k.default.conf.games.default}if(t&&t.length>0){if(!k.default.tmp.getMoreGame)k.default.tmp.getMoreGame={};var n=k.default.tmp.getMoreGame[e];if(!n||n>=t.length){n=0}k.default.tmp.getMoreGame[e]=n+1;return t[n]}}}function O(e){if(k.default.conf&&k.default.conf.games){var t;if(k.default.conf.games[e]){t=k.default.conf.games[e]}else if(k.default.conf.games.default){t=k.default.conf.games.default}if(t&&t.length>0){var n=[];for(var i=0;i<t.length;i++){n.push(t[i].image)}k.default.previewImage({urls:o.default.randomSort(n)})}else{wx.showToast({title:"没有更多游戏！",icon:"info"})}}else{wx.showToast({title:"没有更多游戏！",icon:"info"})}}function U(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;function t(e){var t=Date.now();var n=t-e.last;e.logs.push({ms:n,last:e.last,posted:false});e.total_ms+=n;e.last=t}if(e&&!D[e])return;if(e){t(D[e])}else{for(var n in D){t(D[n])}}}function T(e){if(!D||!D[e]){return null}else{if(D[e].showed){E(e)}return D[e]}}function L(e,t){var n=false;for(var i in e){n=t[i]&&t[i].preload||false;D[i]={pos:i,data:e[i]?e[i]:[],last:Date.now(),duration:0,total_ms:0,preload:n,logs:[],show_logs:[],click_logs:[],open_logs:[],showed:!n}}}function q(e){var t=e.pos,a=t===undefined?"default":t,n=e.count,i=n===undefined?1:n,o=e.success,r=o===undefined?null:o,s=e.fail,u=s===undefined?null:s,f=e.force,l=f===undefined?false:f,d=e.preload,c=d===undefined?false:d;var h=T(a);if(h&&!l){if(!c){D[a].showed=true}r&&r({code:0,data:h["data"],key:"SUCCESS"})}else{k.default.post({url:"/game/ad",data:{pos:a,count:i},success:function e(t){if(t.code==0){if(!Array.isArray(t.data)||Array.isArray(t.data)&&t.data.length!=0){wxsdk.setDenyAd(t.data);var n={},i={};n[a]=t.data;i[a]={preload:c};L(n,i)}r&&r(t)}else{u&&u(t)}},fail:function e(t){u&&u(t)}})}}function M(e){var t=e.data,a=t===undefined?[{pos:"default",count:1,preload:false}]:t,n=e.success,o=n===undefined?null:n,i=e.fail,r=i===undefined?null:i,s=e.force,u=s===undefined?false:s;var f=false;var l=true;var d=false;var c=undefined;try{for(var h=a[Symbol.iterator](),p;!(l=(p=h.next()).done);l=true){var g=p.value;var v=T(g.pos);if(!v||u){f=true;continue}}}catch(e){d=true;c=e}finally{try{if(!l&&h.return){h.return()}}finally{if(d){throw c}}}if(f){k.default.post({url:"/game/ad",data:{pos:a},success:function e(t){if(t.code==0){if(t.data){var n={};for(var i in a){n[a[i].pos]={preload:a[i].preload||false}}L(t.data,n)}o&&o(t)}else{r&&r(t)}},fail:function e(t){r&&r(t)}})}else{var m={};var y=true;var w=false;var _=undefined;try{for(var S=a[Symbol.iterator](),b;!(y=(b=S.next()).done);y=true){var I=b.value;if(!I.preload){D[I.pos].showed=true}m[I.pos]=D[I.pos]["data"]}}catch(e){w=true;_=e}finally{try{if(!y&&S.return){S.return()}}finally{if(w){throw _}}}o&&o({code:0,data:m,key:"SUCCESS"})}}function F(e){var t=e.pos,a=t===undefined?"default":t,n=e.count,i=n===undefined?1:n,o=e.success,r=o===undefined?null:o,s=e.fail,u=s===undefined?null:s,f=e.force,l=f===undefined?true:f,d=e.preload,c=d===undefined?false:d;var h=T(a);if(!l&&h){if(!c){D[a].showed=true}r&&r({code:0,data:h["data"],key:"SUCCESS"})}else{k.default.post({url:"/game/ad/feature",data:{pos:a,count:i},success:function e(t){if(t.code==0){if(!Array.isArray(t.data)||Array.isArray(t.data)&&t.data.length!=0){wxsdk.setDenyAd(t.data);var n={},i={};n[a]=t.data;i[a]={preload:c};L(n,i)}r&&r(t)}else{u&&u(t)}},fail:function e(t){u&&u(t)}})}}function E(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"default";U(e);if(D[e]){D[e].showed=false}}function P(e){var t=e.pos,n=e.ad,i=n===undefined?null:n;if(!t||!D[t]||!D[t].preload){return false}if(i){if(D[t].show_logs&&D[t].show_logs.length>0){for(var a in D[t].show_logs){if(D[t].show_logs[a].id===i.id){return false}}}D[t].show_logs.push(i)}else{D.last=Date.now();D[t].showed=true}U(t);return true}function B(e){var t=e.ad,n=e.pos,i=n===undefined?"default":n,a=e.redirect,o=a===undefined?false:a,r=e.success,s=r===undefined?null:r,u=e.fail,f=u===undefined?null:u,l=e.complete,d=l===undefined?null:l,c=e.isPostLog,h=c===undefined?true:c;var p=t;function g(n){if(!n.image){k.default.log("tapGameAD，ad参数内image属性缺失");return}k.default.previewImage({urls:[n.image],success:function e(t){k.default.log("tapGameAD, success");if(k.default.conf.allow_ad_opened_log){K({ad:n,pos:i})}s&&s(t)},fail:function e(t){k.default.log("tapGameAD, fail");f&&f(t)},complete:function e(t){k.default.log("tapGameAD, complete");d&&d(t)}})}function v(n){if(!k.default.requireSDK("2.2.0")){if(n.image){g(n)}else{k.default.alert("当前微信版本过低，无法使用该功能，请升级到最新微信版本后重试。")}return}if(!n.appid){k.default.log("tapGameAD, ad参数内appid属性缺失");return}wx.navigateToMiniProgram({appId:n.appid,path:n.path,success:function e(t){k.default.log("tapGameAD, success");if(k.default.conf.allow_ad_opened_log){K({ad:n,pos:i})}s&&s(t)},fail:function e(t){k.default.log("tapGameAD, fail");f&&f(t)},complete:function e(t){k.default.log("tapGameAD, complete");d&&d(t)}})}if(!D||!D[i]||!p){k.default.log("tapGameAD pos无效，没有对应数据，或未传ad参数");return}if(h){j({ad:p,pos:i})}if(p.action=="code"){g(p)}else if(p.action=="navigate"){v(p)}else{if(o){v(p)}else{g(p)}}}function G(a){k.default.post({url:"/log/ad",data:a,success:function e(t){for(var n=0;n<a.length;n++){var i=a[n];if(i.pos in D){if(i.commit=="show"){D[i.pos].logs=[];D[i.pos].show_logs=[]}else if(i.commit=="click"){D[i.pos].click_logs=[]}else if(i.commit=="open"){D[i.pos].open_logs=[]}}}k.default.log("广告数据提交成功！")},fail:function e(t){k.default.log("广告数据提交失败！")}})}function j(e){var t=e.ad,n=e.pos,i=n===undefined?"default":n,a=e.post,o=a===undefined?false:a;if(!t||!t.cid||!t.id){return false}var r={cid:t.cid,id:t.id,action:t.action};if(!o){r["tid"]=t.tid;D[i].click_logs.push(r);return false}var s={pos:i?i:"default",tid:t.tid,commit:"click",data:[r]};G([s])}function K(e){var t=e.ad,n=e.pos,i=n===undefined?"default":n,a=e.post,o=a===undefined?false:a;if(!t||!t.cid||!t.id){return false}var r={cid:t.cid,id:t.id,action:t.action};if(!o){r["tid"]=t.tid;D[i].open_logs.push(r);return false}var s={pos:i?i:"default",tid:t.tid,commit:"open",data:[r]};G([s])}function R(e){var t=e.ads,n=t===undefined?null:t,i=e.ad,a=i===undefined?null:i;if(!n&&!a){return false}function o(e){var t=[],n=0,i=null;if(e.logs&&e.logs.length>0){for(var a=0;a<e.logs.length;a++){if(e.logs[a].posted)continue;n+=e.logs[a].ms;i=e.logs[a].last}}if(!n||!e.data||e.data.length===0)return t;var o={pos:e.pos,tid:e.data[0].tid,commit:"show",last:i,ms:n,data:[]};var r={};if(e.preload&&e.show_logs&&e.show_logs.length>0){for(var s in e.show_logs){if(r[e.show_logs[s].id])continue;o.data.push({id:e.show_logs[s].id,cid:e.show_logs[s].cid,action:e.show_logs[s].action});r[e.show_logs[s].id]=1}}else{for(var u=0;u<e.data.length;u++){if(r[e.data[u].id])continue;o.data.push({id:e.data[u].id,cid:e.data[u].cid,action:e.data[u].action});r[e.data[u].id]=1}}if(o.data.length===0){return t}t.push(o);return t}function r(e,t){var n=[],i={},a={},o=null;if(!t.click_logs||t.click_logs.length===0)return n;for(var r=0,s=null;r<t.click_logs.length;r++){o=t.click_logs[r];if(i[o.id])continue;s={pos:e,tid:o.tid,commit:"click",data:[o]};n.push(s);i[o.id]=1}if(t.open_logs&&t.open_logs.length>0){for(var u=0,f=null;u<t.open_logs.length;u++){o=t.open_logs[u];if(a[o.id])continue;f={pos:e,tid:o.tid,commit:"open",data:[o]};n.push(f);a[o.id]=1}}return n}var s=[];if(n){for(var u in n){s=s.concat(o(n[u]));s=s.concat(r(u,n[u]))}}else if(a){s=o(a)}if(s.length>0){G(s)}}function H(a){a.onShow(function(){for(var e in y){var t=y[e];if(t.isShow){a.createBanner({pos:t.pos,style:t.style,ms:t.ms,onResize:t.onResize});t.isShow=false}}for(var n=0;n<s.length;n++){var i=s[n];D[i].showed=true;D[i].total_ms=0;D[i].last=Date.now()}s=[]});a.afterHide(function(){for(var e in y){var t=y[e];t.isShow=t.showed;if(t.isShow){S(t.pos)}if(t.duration>0){c(t)}}for(var n in D){if(D[n].showed){E(n);s.push(n)}}R({ads:D});for(var i in m){if(m[i]&&m[i].count){A(m[i]);m[i]=null}}});a.createBanner=a.checkSDK("2.0.4",f);a.closeBanner=a.checkSDK("2.0.4",S);a.createVideo=a.checkSDK("2.0.4",l);a.createInterstitialAd=a.checkSDK("2.6.0",h);a.showInterstitialAd=a.checkSDK("2.6.0",p);a.postInterstitialData=a.checkSDK("2.6.0",A);a.isEnableVideo=g;a.getMoreGame=x;a.showMoreGame=O;a.getGameAd=q;a.hideGameAd=E;a.tapGameAd=B;a.fetchGameAd=M;a.getPromoGameAd=F;a.postAdClick=j;a.showGameAd=P;function t(){this.quickRefresh=true;this.showMaxCount=5;this.refreshInterval=5;this.currentBannerInfo=null;this.bannerInfoList=[];this.bannerStyle={};this.config={}}t.prototype.init=function(e,t){if(!wx)return;this.config=e;this.config.Refresh_time!==undefined&&(this.refreshInterval=this.config.Refresh_time);this.config.Recreate_1!==undefined&&(this.showMaxCount=this.config.Recreate_1);this.config.Quick_refresh!==undefined&&(this.quickRefresh=this.config.Quick_refresh);if(t){this.bannerStyle=t}else{var n=wx.getSystemInfoSync();var i=n.screenHeight;var a=n.screenWidth;var o=a>i?300:Math.max(300,a);var r=o*.348;var s=(a-o)/2;var u=i-r;this.bannerStyle={left:s,top:u,width:o,height:r}}this.initBannerInfoList();var f=this;setInterval(function(){f.onUpdate()},33)};t.prototype.showBannerAd=function(){if(!wx)return;if(this.currentBannerInfo){this.showBannerAdWithInfo(this.currentBannerInfo)}else{this.randomShowBannerAd(true)}};t.prototype.hideBannerAd=function(){if(!wx)return;this.hideCurrentBannerAd()};t.prototype.initBannerInfoList=function(){var e=[];for(var t in this.config.banner){e.push(this.config.banner[t])}this.bannerInfoList=[];for(var n=0;n<=e.length;n++){var i=e[n];this.bannerInfoList.push({adUnitId:i,isLoading:false,isShow:false,view:null,showCount:0,loadFailCount:0,createTimestamp:0,showTimestamp:0})}};t.prototype.createBannerAdWithInfo=function(t){var n=this;if(t.isLoading){return t}if(t.view){t.view.hide();t.view.destroy();t.view=null}t.showTimestamp=0;t.showCount=0;t.isLoading=true;t.createTimestamp=Date.now();t.view=wx.createBannerAd({adUnitId:t.adUnitId,style:this.bannerStyle});t.view.onLoad(function(){t.isLoading=false;t.loadFailCount=0;if(t.isShow){t.showCount++;t.view.show();t.showTimestamp=Date.now()}});t.view.onError(function(){t.isLoading=false;t.loadFailCount++;t.view.destroy();t.view=null;t.isShow=false;if(t.loadFailCount>=5){var e=n.bannerInfoList.indexOf(t);if(e>-1){n.bannerInfoList.splice(e,1);if(!n.bannerInfoList.length){n.initBannerInfoList()}}}});return t};t.prototype.randomShowBannerAd=function(e){var t=[];var n=1;var i=this;if(e){this.bannerInfoList.forEach(function(e){if(e.view){!e.isLoading&&t.push(e)}else if(n){n--;i.createBannerAdWithInfo(e)}})}if(!t.length)t=this.bannerInfoList;var a=t[Math.floor(Math.random()*t.length)];this.showBannerAdWithInfo(a)};t.prototype.hideCurrentBannerAd=function(){if(!this.currentBannerInfo)return;this.hideBannerAdWithInfo(this.currentBannerInfo);this.currentBannerInfo=null};t.prototype.showBannerAdWithInfo=function(e){if(this.currentBannerInfo!==e){this.hideCurrentBannerAd();this.currentBannerInfo=e}if(!e)return;e.isShow=true;if(!e.view){this.createBannerAdWithInfo(e)}else if(!e.isLoading){e.showCount++;e.view.show();e.showTimestamp=Date.now()}};t.prototype.hideBannerAdWithInfo=function(e){if(!e)return;e.isShow=false;if(!e.view){return}if(!e.isLoading){e.view.hide();if(e.showCount>=this.showMaxCount){e.showCount=0;this.createBannerAdWithInfo(e)}}};t.prototype.onUpdate=function(){if(this.quickRefresh){if(this.currentBannerInfo&&this.currentBannerInfo.view&&this.currentBannerInfo.isShow&&this.currentBannerInfo.showTimestamp){if(Date.now()-this.currentBannerInfo.showTimestamp>=this.refreshInterval*1e3){this.randomShowBannerAd(true)}}}};var n;var e=function(e){n=new t;n.init(a.conf,e)};var i=function(){if(!n)return;n.showBannerAd()};var o=function(){if(!n)return;n.hideBannerAd()};a.initBannerManager=e;a.showBannerAd=i;a.hideBannerAd=o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.initHook=s;var i=n(1);var a=o(i);function o(e){return e&&e.__esModule?e:{default:e}}function r(t,n){t[n]=function(){var e;t.mode=n;if(n=="aldShareAppMessage"){t.mode="shareAppMessage"}return(e=wx)[n].apply(e,arguments)}}function s(t){t.setMode=function(e){t.mode=e};r(t,"previewImage");r(t,"openCustomerServiceConversation");r(t,"shareAppMessage");r(t,"aldShareAppMessage")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});var p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n){if(Object.prototype.hasOwnProperty.call(n,i)){e[i]=n[i]}}}return e};t.initInvite=_;var i=n(1);var w=a(i);function a(e){return e&&e.__esModule?e:{default:e}}function g(e,t){var n={};for(var i in e){if(t.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(e,i))continue;n[i]=e[i]}return n}function o(e){var t=e.pos,n=t===undefined?null:t,i=e.success,a=i===undefined?null:i,o=e.fail,r=o===undefined?null:o;var s={};if(n){s.pos=n}w.default.get({url:"/invited/users/count",data:s,success:function e(t){a&&a(t.data.count)},fail:function e(t){r&&r(t)}})}function r(e){var t=e.pos,n=t===undefined?null:t,i=e.receive,a=i===undefined?true:i,o=e.skip,r=o===undefined?0:o,s=e.limit,u=s===undefined?-1:s,f=e.success,l=f===undefined?null:f,d=e.fail,c=d===undefined?null:d;var h={skip:r,limit:u,receive:a};if(n){h.pos=n}w.default.get({url:"/invited/users",data:h,success:function e(t){l&&l(t.data)},fail:function e(t){c&&c(t)}})}function s(e){var t=e.user,n=e.pos,i=n===undefined?null:n,a=e.success,o=a===undefined?null:a,r=e.fail,s=r===undefined?null:r;var u={users:[{id:t.id,gift:t.gift}]};if(i){u.pos=i}w.default.post({url:"/invited/gift/receive",data:u,success:function e(t){o&&o(t.data.receive[0])},fail:function e(t){s&&s(t)}})}function u(e){var t=e.users,n=e.pos,i=n===undefined?null:n,a=e.success,o=a===undefined?null:a,r=e.fail,s=r===undefined?null:r;var u={users:[]};var f=true;var l=false;var d=undefined;try{for(var c=t[Symbol.iterator](),h;!(f=(h=c.next()).done);f=true){var p=h.value;u.users.push({id:p.id,gift:p.gift})}}catch(e){l=true;d=e}finally{try{if(!f&&c.return){c.return()}}finally{if(l){throw d}}}if(i){u.pos=i}w.default.post({url:"/invited/gift/receive",data:u,success:function e(t){o&&o(t.data.receive)},fail:function e(t){s&&s(t)}})}function f(e,i){if(i&&i.gift){var a={type:e,gift:i.gift,uid:i.uid,share_tid:i.share_tid};var o=w.default.conf[i.gift];if(o){a.receive=true}w.default.post({url:"/share/gift/log",data:a,success:function e(t){if(o){var n=t.data;if(n.is_self&&o.not_allow_self){w.default.alert(o.not_allow_self_tip||"不能领取自己送出的礼物～")}else if(n.user_count>=(o.date_limit||2)){w.default.alert(o.date_limit_tip||"今天已经领取太多次了～")}else if(n.user_share_count>=(o.share_date_limit||1)){w.default.alert(o.share_date_limit_tip||"已经领取过该礼物了～")}else if(n.count>=(o.limit||10)){w.default.alert(o.limit_tip||"该礼物被领光了～")}else{t={gift:i.gift,query:i,conf:o,options:a,data:n};w.default._onGiftCallback&&w.default._onGiftCallback(t)}}}})}}function l(e){var t=e.from,n=e.query,i=e.options;f("share",n)}function d(e){var t=e.from,n=e.scene,i=e.options,a=e.query;f("code",a)}function c(e){w.default._onGiftCallback=e}function h(e){var t=e.gifts,n=e.users,i=n===undefined?true:n,a=e.receive,o=a===undefined?true:a,r=e.dateLimit,s=r===undefined?0:r,u=e.cache,f=u===undefined?60:u,l=e.limit,d=l===undefined?0:l,c=e.success,h=c===undefined?null:c,p=e.fail,g=p===undefined?null:p;if(typeof i!=="boolean"||typeof o!=="boolean"||typeof s!=="number"||typeof f!=="number"||typeof d!=="number"){w.default.log("requestShareGift, 参数格式异常");return}var v=true;var m=[t.sort().toString(),i,o,s,d];var y=m.join("-");if(w.default.shareGiftTempData&&w.default.shareGiftTempData[y]&&Date.now()-w.default.shareGiftTempData[y].ms<f*1e3){v=false}if(v){w.default.post({url:"/share/gift/receive",data:{gifts:t,is_users:i,receive:o,date_limit:s,limit:d},success:function e(t){w.default.shareGiftTempData[y]={data:t.data,ms:Date.now()};h&&h(t.data)},fail:g})}else{h&&h(w.default.shareGiftTempData[y].data)}}function v(e){var t=e.users,n=e.success,i=n===undefined?null:n,a=e.fail,o=a===undefined?null:a;if(!Array.isArray(t)){w.default.log("receiveShareGift, users参数格式错误");return}w.default.post({url:"/share/gift/receive2",data:{users:t},success:function e(t){i&&i(t)},fail:function e(t){o&&o(t)}})}function m(e){var t=e.pos,n=e.bg,i=n===undefined?true:n,a=e.success,o=a===undefined?null:a,r=e.fail,s=r===undefined?null:r,u=g(e,["pos","bg","success","fail"]);w.default.post({url:"/share/qrcode",data:p({pos:t,bg:i,uid:w.default.user.id,share_tid:Date.now()+""},u),success:function e(t){o&&o(t.data)},fail:s})}function y(e){var t=e.pos,n=e.bg,i=n===undefined?true:n,a=e.filePath,o=a===undefined?"":a,r=e.success,s=r===undefined?null:r,u=e.fail,f=u===undefined?null:u,l=e.complete,d=l===undefined?null:l,c=g(e,["pos","bg","filePath","success","fail","complete"]);function h(e){var t=e.codeUrl;wx.downloadFile({url:t,filePath:o,success:function e(t){if(t.statusCode==200){w.default.alert("download success",t.tempFilePath);w.default.log("download success",t.tempFilePath);if(!o){o=t.tempFilePath;wx.saveImageToPhotosAlbum({filePath:t.tempFilePath,success:function e(t){s&&s(t)},fail:function e(t){f&&f(t)},complete:function e(t){d&&d(t)}})}}},fail:function e(t){f&&f(t)},complete:function e(t){d&&d(t)}})}m(p({pos:t,bg:i,success:function e(t){h(t)},fail:f},c))}function _(e){e.getInviteCount=o;e.getInviteUsers=r;e.receiveInviteGift=s;e.receiveInviteGifts=u;e.openFromShare(l);e.openFromCode(d);e.onShareGift=c;e.requestShareGift=h;e.receiveShareGift=v;e.getWXACode=m;e.saveWXACode=y}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.initEvent=f;var i=n(1);var a=o(i);function o(e){return e&&e.__esModule?e:{default:e}}var r={index:0,events:[]};function s(e,t){r.index+=1;r.events.push({event:e,data:t?JSON.stringify(t):null,tm:Date.now()})}function u(){a.default.post({url:"/log/event",data:r,success:function e(t){if(t.code==0){r.events=[]}a.default.log("事件日志提交成功！")},fail:function e(t){a.default.log("事件日志提交失败！")}})}function f(e){e.afterHide(function(){u()});e.traceEvent=s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.initMessage=r;var i=n(1);var s=a(i);function a(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=e.success,n=t===undefined?null:t,i=e.fail,a=i===undefined?null:i,o=e.complete,r=o===undefined?null:o;if(!s.default.conf.msgTemplates||s.default.conf.msgTemplates.length===0){s.default.log("后台未配置订阅信息");return false}wx.requestSubscribeMessage({tmplIds:s.default.conf.msgTemplates,success:function e(t){s.default.log("订阅成功！");u(t);n&&n(t)},fail:function e(t){s.default.log("订阅失败！",t);a&&a(t)},complete:function e(t){r&&r(t)}})}function u(e){s.default.post({url:"/message/subscribe/log",data:{res:e},success:function e(t){s.default.log("订阅日志提交成功！")},fail:function e(t){s.default.log("订阅日志提交失败！")}})}function r(e){e.subscribeMessage=e.checkSDK("2.8.2",o)}}]);